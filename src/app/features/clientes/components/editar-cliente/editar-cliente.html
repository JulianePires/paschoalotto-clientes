<div class="flex flex-col p-8 gap-4 min-h-full">
  <button mat-button class="back-button self-start" (click)="voltar()">
    <mat-icon>arrow_back</mat-icon>
    Voltar
  </button>

  <form [formGroup]="form" (ngSubmit)="abrirConfirmacaoEditar()" class="flex flex-col gap-4">
    <div class="w-24 h-24 rounded-full overflow-hidden mb-8 bg-gray-300 self-center flex items-center justify-center cursor-pointer relative group"
      (click)="onAvatarClick($event)"
      (keydown)="onAvatarKeydown($event)"
      role="button"
      tabindex="0"
      aria-label="Alterar logotipo do cliente">
      @if(form.get('logotipo')?.value !== '') {
      <img [src]="form.get('logotipo')?.value" alt="Logotipo" class="w-full h-full object-cover" />
      } @else {
        <mat-icon>upload</mat-icon>
      }

      <!-- overlay edit icon (appears on hover / focus) -->
      <div class="absolute inset-0 bg-black bg-opacity-25 flex items-center justify-center opacity-0 group-hover:opacity-100 group-focus:opacity-100 transition-opacity" aria-hidden="true">
        <mat-icon class="text-white">edit</mat-icon>
      </div>

      <input #fileInput type="file" (change)="uploadLogotipo($event)" class="hidden" />
    </div>

    <mat-form-field appearance="fill" class="w-full">
      <mat-label>Nome</mat-label>
      <input matInput formControlName="nome" />
      @if (form.get('nome')?.hasError('required')) {
      <mat-error>Nome é obrigatório</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="fill" class="w-full">
      <mat-label>Email</mat-label>
      <input matInput formControlName="email" />
      @if (form.get('email')?.hasError('required')) {
      <mat-error>Email é obrigatório</mat-error>

      } @if (form.get('email')?.hasError('email')) {
      <mat-error>Email inválido</mat-error>

      }
    </mat-form-field>

    <mat-form-field appearance="fill" class="w-full">
      <mat-label>Telefone</mat-label>
  <input matInput formControlName="telefone" (blur)="telefoneBlur()" mask="(00) 00000-0000" />
      @if(form.get('telefone')?.hasError('required')) {
      <mat-error>Telefone é obrigatório</mat-error>
      } @if(form.get('telefone')?.hasError('invalidPhone')) {
      <mat-error>Telefone inválido (mínimo 8 dígitos)</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="fill" class="w-full">
      <mat-label>Cidade</mat-label>
      <input matInput formControlName="cidade" />
      @if(form.get('cidade')?.hasError('required')) {
      <mat-error>Cidade é obrigatória</mat-error>
      }
    </mat-form-field>

    <div class="flex gap-4 justify-end">
      <button mat-stroked-button type="button" (click)="voltar()">Cancelar</button>
      <button mat-flat-button color="primary" type="submit">Salvar</button>
    </div>
  </form>
</div>
